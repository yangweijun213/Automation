require 'rubygems'    
require 'watir-classic'  #watir和watir-classic不能同时存在 

ie = Watir::IE.new 

# Attach HttpWatch
control = WIN32OLE.new('HttpWatch.Controller')
plugin = control.IE.Attach(ie.ie)

#Clear the HttpWatch Log
plugin.Clear()

#Turn Off Filtering
plugin.Log.EnableFilter(true) 

# Start recording
plugin.Record() 

# Open page
ie.goto('#$url') 

# Stop recording
plugin.Stop()

#Save an HttpWatch Log (.hwl) file
plugin.Log.ExportFieldsAsCSV('D:\\workspace\\Automation_PST\\Automation\\Ruby_Watir_HttpWatch\log\\OpenPage.csv','Started, Page Title, Page ID, Device Name, User Name, Time, Sent, Received, Method, Result, Type, URL, Render Start, DOM Load, HTTP Load, Page Load, Network, Cache Read')

#Setting a text field
#ie.text_field(:name =>"j_username").set "sa4" #可以使用逗号或者=>
ie.text_field(:name, "j_username").set "sa4"
ie.text_field(:name, "j_password").set "password"

#Clicking a button
ie.button(:name, "submit").click

#Checking for text in a page
puts ie.text.include?("Home")



