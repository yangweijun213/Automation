require 'rubygems'    
require 'watir-classic'  #watir和watir-classic不能同时存在 

#加载默认路径引入公共类
require File.dirname(__FILE__) + '/ConfigureClass'
require File.dirname(__FILE__) + '/DateTimeClass'

#define transaction name
$transactionName = "login"

# Open the IE browser using Watir
ie = Watir::IE.new 

# Attach HttpWatch
control = WIN32OLE.new('HttpWatch.Controller')
plugin = control.IE.Attach(ie.ie)

#Clear the HttpWatch Log
plugin.Clear()

#Turn Off Filtering
plugin.Log.EnableFilter(true) 

# Start recording
plugin.Record() 

# Open page
ie.goto("#$url") 

# Stop recording
plugin.Stop()

#Save an HttpWatch Log (.hwl) file
dateTime = DateTimeClass.new()
abc.getTimeStamp()
plugin.Log.ExportFieldsAsCSV("#$transactionName","#$fieldList")

#Setting a text field
#ie.text_field(:name =>"j_username").set "sa4" #可以使用逗号或者=>
ie.text_field(:name, "j_username").set "#$userName"
ie.text_field(:name, "j_password").set "#$password"

#Clicking a button
ie.button(:name, "submit").click

#Checking for text in a page
puts ie.text.include?("Home")



